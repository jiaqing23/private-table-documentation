

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>federated_learning &mdash; PrivateTable 1.0.0 documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="prev" title="private_machine_learning" href="../private_machine_learning/index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> PrivateTable
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../data_domain/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">data_domain</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../privacy_budget/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">privacy_budget</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../privacy_budget_tracker/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">privacy_budget_tracker</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../private_mechanisms/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">private_mechanisms</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../private_table/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">private_table</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../private_machine_learning/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">private_machine_learning</span></code></a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#"><code class="xref py py-mod docutils literal notranslate"><span class="pre">federated_learning</span></code></a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">PrivateTable</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li><code class="xref py py-mod docutils literal notranslate"><span class="pre">federated_learning</span></code></li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../_sources/api/federated_learning/index.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="federated-learning">
<h1><a class="reference internal" href="#module-federated_learning" title="federated_learning"><code class="xref py py-mod docutils literal notranslate"><span class="pre">federated_learning</span></code></a><a class="headerlink" href="#federated-learning" title="Permalink to this headline">¶</a></h1>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#federated_learning.FedAvgClient" title="federated_learning.FedAvgClient"><code class="xref py py-obj docutils literal notranslate"><span class="pre">FedAvgClient</span></code></a></p></td>
<td><p>Client side of FederatedAveraging (FedAvg) algorithm (<a class="reference external" href="https://arxiv.org/pdf/1602.05629.pdf">https://arxiv.org/pdf/1602.05629.pdf</a>).</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#federated_learning.FedAvgServer" title="federated_learning.FedAvgServer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">FedAvgServer</span></code></a></p></td>
<td><p>Server side of FederatedAveraging (FedAvg) algorithm (<a class="reference external" href="https://arxiv.org/pdf/1602.05629.pdf">https://arxiv.org/pdf/1602.05629.pdf</a>).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#federated_learning.DPFedAvgClient" title="federated_learning.DPFedAvgClient"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DPFedAvgClient</span></code></a></p></td>
<td><p>Client side of DP-FedAvg algorithm (<a class="reference external" href="https://arxiv.org/pdf/1710.06963.pdf">https://arxiv.org/pdf/1710.06963.pdf</a>).</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#federated_learning.DPFedAvgServer" title="federated_learning.DPFedAvgServer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DPFedAvgServer</span></code></a></p></td>
<td><p>Server side of DP-FedAvg algorithm (<a class="reference external" href="https://arxiv.org/pdf/1710.06963.pdf">https://arxiv.org/pdf/1710.06963.pdf</a>).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#federated_learning.flat_clip" title="federated_learning.flat_clip"><code class="xref py py-obj docutils literal notranslate"><span class="pre">flat_clip</span></code></a></p></td>
<td><p>Helper function used to clip gradient with L2-norm bound of gradient_norm_bound.</p></td>
</tr>
</tbody>
</table>
<span class="target" id="module-federated_learning"></span><dl class="py class">
<dt class="sig sig-object py" id="federated_learning.DPFedAvgClient">
<em class="property"><span class="pre">class</span> </em><span class="sig-name descname"><span class="pre">DPFedAvgClient</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/federated_learning.html#DPFedAvgClient"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#federated_learning.DPFedAvgClient" title="Permalink to this definition">¶</a></dt>
<dd><p>Client side of DP-FedAvg algorithm (<a class="reference external" href="https://arxiv.org/pdf/1710.06963.pdf">https://arxiv.org/pdf/1710.06963.pdf</a>).
The implementation is based on Tensorflow.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_fn</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[[], <code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code>]) – Function used to create instance of model, should be the same as server.</p></li>
<li><p><strong>loss_fn</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[[<code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">array</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">array</span></code>]) – Function that receives model and data batch, and return the loss value caluclated by tf.keras.losses.</p></li>
<li><p><strong>data</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Iterable</span></code>) – Client’s traning data. Each element represent one training sample.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="federated_learning.DPFedAvgClient.split_data">
<span class="sig-name descname"><span class="pre">split_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">minibatch_size</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/federated_learning.html#DPFedAvgClient.split_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#federated_learning.DPFedAvgClient.split_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Function used to split data into minibatches with size of minibatch_size.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>minibatch_size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Size of minibatch.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>List of batches data. Each element in the list is list of data of one minibatch.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="federated_learning.DPFedAvgClient.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">global_weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minibatch_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epoch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gradient_norm_bound</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/federated_learning.html#DPFedAvgClient.train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#federated_learning.DPFedAvgClient.train" title="Permalink to this definition">¶</a></dt>
<dd><p>Function for training the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>global_weights</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">array</span></code>) – Global weights received from server.</p></li>
<li><p><strong>minibatch_size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Size of a single minibatch.</p></li>
<li><p><strong>epoch</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Number of epoch.</p></li>
<li><p><strong>gradient_norm_bound</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – L2-norm bound of gradient.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>return model gradient and number of data used for training.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="federated_learning.DPFedAvgClient.train_step">
<span class="sig-name descname"><span class="pre">train_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">minibatch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gradient_norm_bound</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/federated_learning.html#DPFedAvgClient.train_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#federated_learning.DPFedAvgClient.train_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Function for training the model using one minibatch.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>minibatch</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">array</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>]) – List of data of minibacth.</p></li>
<li><p><strong>initial_weights</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">array</span></code>) – Initial global weight get from server.</p></li>
<li><p><strong>gradient_norm_bound</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – L2-norm bound of gradient.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="federated_learning.DPFedAvgServer">
<em class="property"><span class="pre">class</span> </em><span class="sig-name descname"><span class="pre">DPFedAvgServer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clients</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">total_data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/federated_learning.html#DPFedAvgServer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#federated_learning.DPFedAvgServer" title="Permalink to this definition">¶</a></dt>
<dd><p>Server side of DP-FedAvg algorithm (<a class="reference external" href="https://arxiv.org/pdf/1710.06963.pdf">https://arxiv.org/pdf/1710.06963.pdf</a>).
The implementation is based on Tensorflow.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_fn</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[[], <code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code>]) – Function used to create instance of model, should be the same as clients.</p></li>
<li><p><strong>clients</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>]) – List of client objects used to identify each client.</p></li>
<li><p><strong>total_data</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Number of total data.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="federated_learning.DPFedAvgServer.gaussian_noise">
<span class="sig-name descname"><span class="pre">gaussian_noise</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">standard_deviation</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/federated_learning.html#DPFedAvgServer.gaussian_noise"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#federated_learning.DPFedAvgServer.gaussian_noise" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function for adding Gaussian noise.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>]) – Input data</p></li>
<li><p><strong>standard_deviation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – Standard deviation of Gaussian noise.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Input data with noise</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="federated_learning.DPFedAvgServer.select_clients">
<span class="sig-name descname"><span class="pre">select_clients</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">number</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/federated_learning.html#DPFedAvgServer.select_clients"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#federated_learning.DPFedAvgServer.select_clients" title="Permalink to this definition">¶</a></dt>
<dd><p>Select clients from self.clients randomly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>number</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Number of client to select.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>]</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>List of clients object in self.clients.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="federated_learning.DPFedAvgServer.send_train_request">
<em class="property"><span class="pre">abstract</span> </em><span class="sig-name descname"><span class="pre">send_train_request</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">client</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minibatch_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epoch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gradient_norm_bound</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/federated_learning.html#DPFedAvgServer.send_train_request"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#federated_learning.DPFedAvgServer.send_train_request" title="Permalink to this definition">¶</a></dt>
<dd><p>Abstract method for sending training request to client.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>client</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>) – Target client used for training.</p></li>
<li><p><strong>minibatch_size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Size of minibatch used by client during training.</p></li>
<li><p><strong>epoch</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Number of epoch for training.</p></li>
<li><p><strong>gradient_norm_bound</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – L2-norm bound of gradient.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="federated_learning.DPFedAvgServer.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">clients</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minibatch_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epoch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gradient_norm_bound</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_scale</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/federated_learning.html#DPFedAvgServer.train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#federated_learning.DPFedAvgServer.train" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to train the model by calling clients using multithreading.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>clients</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>]) – List of client objects used to identify each client.</p></li>
<li><p><strong>minibatch_size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Size of minibatch used by client during training.</p></li>
<li><p><strong>epoch</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Number of epoch used by client for training.</p></li>
<li><p><strong>gradient_norm_bound</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – L2-norm bound of gradient.</p></li>
<li><p><strong>noise_scale</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – Value of noise scale. Higher noise scale correspond to higher noise and lower privacy budget.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="federated_learning.DPFedAvgServer.train_client">
<span class="sig-name descname"><span class="pre">train_client</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">client</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minibatch_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epoch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gradient_norm_bound</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">res</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idx</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/federated_learning.html#DPFedAvgServer.train_client"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#federated_learning.DPFedAvgServer.train_client" title="Permalink to this definition">¶</a></dt>
<dd><p>Intermediate function to call <a class="reference internal" href="#federated_learning.DPFedAvgServer.send_train_request" title="federated_learning.DPFedAvgServer.send_train_request"><code class="xref py py-func docutils literal notranslate"><span class="pre">send_train_request()</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>client</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>) – Target client used for training.</p></li>
<li><p><strong>minibatch_size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Size of minibatch used by client during training.</p></li>
<li><p><strong>epoch</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Number of epoch for training.</p></li>
<li><p><strong>gradient_norm_bound</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – L2-norm bound of gradient.</p></li>
<li><p><strong>res</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>]) – Reference to array to record the model weight returned by client.</p></li>
<li><p><strong>idx</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Index of array res to record the model weight returned by client.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="federated_learning.FedAvgClient">
<em class="property"><span class="pre">class</span> </em><span class="sig-name descname"><span class="pre">FedAvgClient</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/federated_learning.html#FedAvgClient"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#federated_learning.FedAvgClient" title="Permalink to this definition">¶</a></dt>
<dd><p>Client side of FederatedAveraging (FedAvg) algorithm (<a class="reference external" href="https://arxiv.org/pdf/1602.05629.pdf">https://arxiv.org/pdf/1602.05629.pdf</a>).
The implementation is based on Tensorflow.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_fn</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[[], <code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code>]) – Function used to create instance of model, should be the same as server.</p></li>
<li><p><strong>loss_fn</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[[<code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">array</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">array</span></code>]) – Function that receives model and data batch, and return the loss value caluclated by tf.keras.losses.</p></li>
<li><p><strong>data</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Iterable</span></code>) – Client’s traning data. Each element represent one training sample.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="federated_learning.FedAvgClient.split_data">
<span class="sig-name descname"><span class="pre">split_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">minibatch_size</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/federated_learning.html#FedAvgClient.split_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#federated_learning.FedAvgClient.split_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Function used to split data into minibatches with size of minibatch_size.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>minibatch_size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Size of minibatch.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>List of batches data. Each element in the list is list of data of one minibatch.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="federated_learning.FedAvgClient.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">global_weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minibatch_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epoch</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/federated_learning.html#FedAvgClient.train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#federated_learning.FedAvgClient.train" title="Permalink to this definition">¶</a></dt>
<dd><p>Function for training the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>global_weights</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">array</span></code>) – Global weights received from server.</p></li>
<li><p><strong>minibatch_size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Size of a single minibatch.</p></li>
<li><p><strong>epoch</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Number of epoch.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>return model weights and number of data used for training.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="federated_learning.FedAvgClient.train_step">
<span class="sig-name descname"><span class="pre">train_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">minibatch</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/federated_learning.html#FedAvgClient.train_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#federated_learning.FedAvgClient.train_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Function for training the model using one minibatch.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>minibatch</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">array</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>]) – List of data of minibacth.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="federated_learning.FedAvgServer">
<em class="property"><span class="pre">class</span> </em><span class="sig-name descname"><span class="pre">FedAvgServer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clients</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/federated_learning.html#FedAvgServer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#federated_learning.FedAvgServer" title="Permalink to this definition">¶</a></dt>
<dd><p>Server side of FederatedAveraging (FedAvg) algorithm (<a class="reference external" href="https://arxiv.org/pdf/1602.05629.pdf">https://arxiv.org/pdf/1602.05629.pdf</a>).
The implementation is based on Tensorflow.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_fn</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[[], <code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code>]) – Function used to create instance of model, should be the same as clients.</p></li>
<li><p><strong>clients</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>]) – List of client objects used to identify each client.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="federated_learning.FedAvgServer.select_clients">
<span class="sig-name descname"><span class="pre">select_clients</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">number</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/federated_learning.html#FedAvgServer.select_clients"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#federated_learning.FedAvgServer.select_clients" title="Permalink to this definition">¶</a></dt>
<dd><p>Select clients from self.clients randomly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>number</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Number of client to select.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>]</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>List of clients object in self.clients.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="federated_learning.FedAvgServer.send_train_request">
<em class="property"><span class="pre">abstract</span> </em><span class="sig-name descname"><span class="pre">send_train_request</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">client</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minibatch_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epoch</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/federated_learning.html#FedAvgServer.send_train_request"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#federated_learning.FedAvgServer.send_train_request" title="Permalink to this definition">¶</a></dt>
<dd><p>Abstract method for sending training request to client.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>client</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>) – Target client used for training.</p></li>
<li><p><strong>minibatch_size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Size of minibatch used by client during training.</p></li>
<li><p><strong>epoch</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Number of epoch for training.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="federated_learning.FedAvgServer.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">clients</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minibatch_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epoch</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/federated_learning.html#FedAvgServer.train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#federated_learning.FedAvgServer.train" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to train the model by calling clients using multithreading.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>clients</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>]) – List of client objects used to identify each client.</p></li>
<li><p><strong>minibatch_size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Size of minibatch used by client during training.</p></li>
<li><p><strong>epoch</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Number of epoch used by client for training.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="federated_learning.FedAvgServer.train_client">
<span class="sig-name descname"><span class="pre">train_client</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">client</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minibatch_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epoch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">res</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idx</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/federated_learning.html#FedAvgServer.train_client"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#federated_learning.FedAvgServer.train_client" title="Permalink to this definition">¶</a></dt>
<dd><p>Intermediate function to call <a class="reference internal" href="#federated_learning.FedAvgServer.send_train_request" title="federated_learning.FedAvgServer.send_train_request"><code class="xref py py-func docutils literal notranslate"><span class="pre">send_train_request()</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>client</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>) – Target client used for training.</p></li>
<li><p><strong>minibatch_size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Size of minibatch used by client during training.</p></li>
<li><p><strong>epoch</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Number of epoch for training.</p></li>
<li><p><strong>res</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>]) – Reference to array to record the model weight returned by client.</p></li>
<li><p><strong>idx</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Index of array res to record the model weight returned by client.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="federated_learning.flat_clip">
<span class="sig-name descname"><span class="pre">flat_clip</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gradient</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gradient_norm_bound</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/federated_learning.html#flat_clip"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#federated_learning.flat_clip" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function used to clip gradient with L2-norm bound of gradient_norm_bound.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gradient</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">array</span></code>) – The gradient to be clipepd.</p></li>
<li><p><strong>gradient_norm_bound</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – L2-norm bound of gradient.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">array</span></code></p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The clipped gradient.</p>
</dd>
</dl>
</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="../private_machine_learning/index.html" class="btn btn-neutral float-left" title="private_machine_learning" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, NTU SCRiPTS.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>